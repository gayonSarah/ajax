<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
      integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="container"></div>
    <script>
      var cartItemCounter = document.querySelector("span.cart-item-count");
      jQuery.ajax("/products").done(function (data) {
        console.log(data);
        var content;
        var option;
        $.each(data.products, function (i, item) {
          // console.log(item);
          content +=
            '<div class="card" style="width: 30rem; ">' +
            '<img src="' +
            item.image.src +
            ' class="card-img-top" alt="..." style="width: 17rem;"/>' +
            '<div class="card-body"' +
            ' <h5 class="card-title">' +
            item.title +
            "</h5><br>" +
            +'<p class="card-text text-align-center">' +
            item.body_html +
            ".</p>";
          option = "<div>";
          $.each(item.variants, function (i, item) {
            // console.log(item);
            option +=
              '<button type="bouton" class="btn btn-info m-1" onclick="sendData(' +
              item.id +
              ')">' +
              item.title +
              "</button>";
          });
          option +=
            "</div>" + ' <a href="#" class="btn btn-primary">Acheter</a></div>';
        });
        document.querySelector(".container").innerHTML = content + option;
      });

      function sendData(id) {
        var idVariante = id;
        $.post("/order", {
          order: {
            email: "email10+TEST@gmail.com",
            line_items: [
              {
                variant_id: 34476457590933,
                quantity: 1,
              },
            ],
          },
        });
        console.log(idVariante);
      }
    </script>
  </body>
</html>
